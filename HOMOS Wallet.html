<!DOCTYPE html><html lang="ar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HOMOS Wallet </title>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      direction: rtl;
      background: #f4f4f4;
      padding: 20px;
    }
    .hidden {
      display: none;
    }
    input, button {
      display: block;
      margin: 10px 0;
      padding: 10px;
      width: 100%;
      max-width: 300px;
    }
    button {
      background-color: #4CAF50;
      color: white;
      border: none;
      cursor: pointer;
    }
    .sub-section {
      margin-top: 20px;
      padding: 10px;
      background: white;
      border: 1px solid #ccc;
    }
    .box {
      background: #eee;
      padding: 10px;
      border-radius: 5px;
    }
  </style>
</head>
<body><div id="loginScreen">
  <h2>تسجيل الدخول باستخدام رقم الهاتف</h2>
  <input type="text" id="phoneNumber" placeholder="أدخل رقم الهاتف مثل: +201234567890">
  <div id="recaptcha-container"></div>
  <button onclick="sendOTP()">إرسال OTP</button>
  <input type="text" id="otpCode" placeholder="أدخل رمز OTP">
  <button onclick="verifyOTP()">تسجيل الدخول</button>
</div><div id="mainScreen" class="hidden">
  <h2>مرحبًا <span id="welcomePhone"></span>!</h2>
  <p>رصيدك: <span id="userBalance">0</span> جنيه</p>
  <button onclick="toggleSection('deposit')">إيداع</button>
  <button onclick="toggleSection('withdraw')">سحب</button>  <div id="deposit" class="sub-section hidden">
    <h3>طلب إيداع</h3>
    <p>يرجى تحويل المبلغ إلى الرقم التالي:</p>
    <div class="box">
      <strong id="receiverNumber">01012265953</strong>
      <button onclick="copyReceiver()">نسخ</button>
    </div>
    <form id="depositForm">
      <input type="number" id="amount" placeholder="المبلغ" required>
      <input type="text" id="fromPhone" placeholder="رقم الهاتف المرسل منه" required>
      <input type="file" id="screenshot" required>
      <button type="submit">إرسال الطلب</button>
    </form>
  </div>  <div id="withdraw" class="sub-section hidden">
    <h3>طلب سحب</h3>
    <form id="withdrawForm">
      <input type="number" id="withdrawAmount" placeholder="المبلغ" required>
      <input type="text" id="withdrawPhone" placeholder="رقم الهاتف الذي تريد التحويل إليه" required>
      <button type="submit">طلب سحب</button>
    </form>
  </div>  <div id="adminControl" class="hidden">
    <h4>إضافة رصيد لمستخدم:</h4>
    <input type="text" id="targetPhone" placeholder="رقم الهاتف">
    <input type="number" id="adminAmount" placeholder="المبلغ">
    <button onclick="adminAdd()">إضافة</button>
  </div>
</div><script>
  const firebaseConfig = {
    apiKey: "AIzaSyCWyQfMmzp41jTYV4GXFViV2wMMTIiP8XU",
    authDomain: "wallet-52a17.firebaseapp.com",
    projectId: "wallet-52a17",
    storageBucket: "wallet-52a17.appspot.com",
    messagingSenderId: "440517088889",
    appId: "1:440517088889:web:a862ab37106851c66066a8",
    measurementId: "G-28Z0S2BGEV"
  };
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();

  let confirmationResult;

  window.onload = function() {
    window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier('recaptcha-container', {
      'size': 'normal',
      'callback': function(response) {
        console.log("reCAPTCHA solved");
      }
    });
    recaptchaVerifier.render();
  }

  function sendOTP() {
    const phoneNumber = document.getElementById("phoneNumber").value;
    auth.signInWithPhoneNumber(phoneNumber, window.recaptchaVerifier)
      .then(function (result) {
        confirmationResult = result;
        alert("تم إرسال OTP");
      })
      .catch(function (error) {
        alert("خطأ: " + error.message);
      });
  }

  function verifyOTP() {
    const code = document.getElementById("otpCode").value;
    confirmationResult.confirm(code).then(function (result) {
      const user = result.user;
      const phone = user.phoneNumber;
      document.getElementById("loginScreen").classList.add("hidden");
      document.getElementById("mainScreen").classList.remove("hidden");
      document.getElementById("welcomePhone").innerText = phone;

      if (phone === "+201012265953") {
        document.getElementById("adminControl").classList.remove("hidden");
      }
    }).catch(function (error) {
      alert("رمز OTP غير صحيح");
    });
  }

  function toggleSection(id) {
    document.querySelectorAll('.sub-section').forEach(section => {
      section.classList.add("hidden");
    });
    document.getElementById(id).classList.remove("hidden");
  }

  function copyReceiver() {
    const number = document.getElementById("receiverNumber").textContent;
    navigator.clipboard.writeText(number);
    alert("تم نسخ الرقم: " + number);
  }

  document.getElementById('depositForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const amount = document.getElementById('amount').value;
    const fromPhone = document.getElementById('fromPhone').value;
    const phone = document.getElementById('welcomePhone').innerText;

    const whatsappNumber = "201016553764";
    const msg = `طلب إيداع\nالمبلغ: ${amount} جنيه\nمن رقم: ${fromPhone}\nلحساب المستخدم: ${phone}\nيرجى تحويل المبلغ إلى: 01012265953`;

    const whatsappURL = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(msg)}`;
    window.open(whatsappURL, "_blank");

    alert("تم إرسال الطلب، يرجى إرسال صورة التحويل عبر واتساب.");
    document.getElementById('depositForm').reset();
  });

  document.getElementById('withdrawForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const amount = document.getElementById('withdrawAmount').value;
    const targetPhone = document.getElementById('withdrawPhone').value;
    const phone = document.getElementById('welcomePhone').innerText;

    const whatsappNumber = "201016553764";
    const msg = `طلب سحب\nالمبلغ: ${amount} جنيه\nمن حساب: ${phone}\nإلى رقم: ${targetPhone}`;

    const whatsappURL = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(msg)}`;
    window.open(whatsappURL, "_blank");

    alert("تم إرسال طلب السحب.");
  });

  function adminAdd() {
    const phone = document.getElementById("targetPhone").value;
    const amount = document.getElementById("adminAmount").value;
    alert(`تمت إضافة ${amount} جنيه لرقم ${phone}`);
  }
</script></body>
</html>